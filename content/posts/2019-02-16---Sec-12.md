---
title: Cross-Site Scripting
date: '2019-02-16'
time: '☕️'
template: "post"
draft: false
slug: "XSS-vulnerability"
category: "Cybersecurity"
tags:
  - "Cybersecurity"
description: "Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into a trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user."
---

This article was done using my notes from a book titled WEB Hacking 101 written by Peter Yaworksi in 2018.

<sub>Yaworksi P. (2018). Web Hacking 101, How To Make Money Hacking Ethically</sub>

## What are XSS Injection ?

According to OWASP (2019), Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into a trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user.

An attacker can use XSS to send a malicious script to an unsuspecting user. The end user’s browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site.

<sub>OWASP (2019). Cross-site Scripting (XSS), url : https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)</sub>

## A famous study case

One of the most famous examples of a cross-site scripting (or XSS) vulnerability was
the Myspace Samy Worm created by Samy Kamkar. In October 2005, Samy exploited
a XSS vulnerability on Myspace which allowed him to store an JavaScript payload on
his profile. When a logged in user visited his Myspace profile, the payload code would
execute, making the viewer Samy’s friend on Myspace, and updating the viewer’s profile
to display the text, “but most of all, samy is my hero”. Then, the code would copy itself
to the viewer’s profile and continue infecting other Myspace user pages.

## How XSS Injections work

XSS vulnerabilities occur when websites render certain characters unsanitized,
which cause browsers to execute unintended JavaScript. These characters include double
quotes (“), single quotes (‘), and angle brackets (< >). They are special because they are
used in HTML and JavaScript to define a web page’s structure. For example, if a site didn’t
sanitize angle brackets, you could insert < script></ script>:

```
<script>alert(document.domain)</script>
```

When this payload is submitted to a website and rendered unsanitized, the < script></ script>
tags instructs the browser to execute the JavaScript between them. In this case, the
payload would execute the alert function, which creates a popup dialog that displays
the information passed to alert.

If a site was properly sanitizing these characters, they would be rendered as HTML
entities. Viewing the page source for a webpage with them would show :

```
 “ as &quot; or &#34;

 ‘ as &apos; or &39;

 < as &lt; or &#60;

  > as &gt; or &#62;
```

## Types of XSS Injections

<sub>OWASP (2019). Cross-site Scripting (XSS), url : https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)</sub>

### 1. Stored XSS

Stored XSS generally occurs when user input is stored on the target server, such as in a database, in a message forum, visitor log, comment field, etc. And then a victim is able to retrieve the stored data from the web application without that data being made safe to render in the browser.

### 2. Reflected XSS

Reflected XSS occurs when user input is immediately returned by a web application in an error message, search result, or any other response that includes some or all of the input provided by the user as part of the request, without that data being made safe to render in the browser, and without permanently storing the user provided data.

### 3. DOM based XSS

DOM Based XSS is a form of XSS where the entire tainted data flow from source to sink takes place in the browser, i.e., the source of the data is in the DOM, the sink is also in the DOM, and the data flow never leaves the browser.

### 4. Client XSS

Client XSS occurs when untrusted user supplied data is used to update the DOM with an unsafe JavaScript call. A JavaScript call is considered unsafe if it can be used to introduce valid JavaScript into the DOM. This source of this data could be from the DOM, or it could have been sent by the server (via an AJAX call, or a page load). The ultimate source of the data could have been from a request, or from a stored location on the client or the server. As such, you can have both Reflected Client XSS and Stored Client XSS.

### 5. Server XSS

Server XSS occurs when untrusted user supplied data is included in an HTML response generated by the server. The source of this data could be from the request, or from a stored location. As such, you can have both Reflected Server XSS and Stored Server XSS.

In this case, the entire vulnerability is in server-side code, and the browser is simply rendering the response and executing any valid script embedded in it.

## What to lookout for ?

The impact of XSS depends on a variety of factors, including whether it’s stored or
reflected, whether cookies are accessible, where the payload executes, and so on.
Despite the potential implications, fixing XSS vulnerabilities is often easy and only
requires software developers to sanitize user input (just like HTML injection) before
rendering it.

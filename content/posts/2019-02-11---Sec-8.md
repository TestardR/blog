---
title: HTTP Parameter Pollution
date: '2019-02-11'
time: '☕️'
template: "post"
draft: false
slug: "HTTP-vulnerability"
category: "Cybersecurity"
tags:
  - "Cybersecurity"
description: "HPP refers to manipulating how a website treats param-
eters it receives during HTTP requests. The vulnerability occurs when parameters are
injected and trusted by the vulnerable website, leading to unexpected behavior."
---

This article was done using my notes from a book titled WEB Hacking 101 written by Peter Yaworksi in 2018.

<sub>Yaworksi P. (2018). Web Hacking 101, How To Make Money Hacking Ethically</sub>

## What are Open Redirect Vulnerabilites

As said in the summary, an HTTP Parameter Pollution (HPP), refers to manipulating how a website treats param-
eters it receives during HTTP requests. The vulnerability occurs when parameters are injected and trusted by the vulnerable website, leading to unexpected behavior.

This can happen both on the back-end, server-side, and on the front-end, client-side.

## Server-side HPP

In server-side HPP, you send the server unexpected information in an attempt to make the server-side code return unexpected results. Because you can’t
see how the server’s code functions, server-side HPP is dependent on you identifying potentially vulnerable parameters and experimenting with them.

A server-side example of HPP could happen if your bank initiated transfers through its website that were processed on its servers by accepting URL parameters. Say that you
could transfer money by filling values in the three URL parameters from, to, and amount, which would specify the account number to transfer money from, the account to transfer
to, and the amount to transfer, in that order.

A URL with these parameters that transfers \$5,000 from account number 12345 to account 67890 might look like:

```
https://www.bank.com/transfer?from=12345&to=67890&amount=5000

```

But what happens if you submit two, like the following:

```

https://www.bank.com/transfer?from=12345&to=67890&amount=5000&from=ABCDEF

```

Instead of transferring \$5,000 from account 12345 to 67890, the server-side code would use the second parameter and send money from account ABCDEF to 67890.

HPP server-side vulnerabilities depend on how the server behaves when receiving multiple parameters with the same name. For example, PHP/Apache
use the last occurrence, Apache Tomcat uses the first occurrence, ASP/IIS use all occurrences, and so on. As a result, there is no single guaranteed process for handling
multiple parameter submissions with the same name and finding HPP will take some experimentation to confirm how the site you’re testing works.

## Client-side HPP

HPP client-side vulnerabilities involve the ability to inject parameters into a URL, which are subsequently reflected back on the page to the user.

Luca Carettoni and Stefano di Paola, two researchers who presented on this vulnerability
type in 2009, came up with a simplified example for use to understand quickly.
Take this URL http://host/page.php?par=123%26action=edit and the following server-side
code:

```

<? $val=htmlspecialchars($_GET['par'],ENT_QUOTES); ?>

<a href="/page.php?action=view&par='.<?=$val?>.'">View Me!</a>

```

Here, the code generates a new URL based on the user-entered URL. The generated URL includes an action parameter and a par parameter, the second of which is determined
by the user’s URL.

In the URL, an attacker passed the value 123%26action=edit as the value for par in the URL. %26 is the URL encoded value for &, which means that
when the URL is parsed, the %26 is interpreted as &. This adds an additional parameter to the generated href link without adding an explicit action parameter.

Using & and not %26 instread would have interpreted par and action as two separate parameters. In order to work around this, the %26 is used so
that action isn’t initially recognized as a separate parameter, so par’s value becomes 123%26action=edit.

Now, par (with the encoded & as %26) would be passed to the function htmlspecialchars.
This function converts special characters, such as %26 to their HTML encoded values
resulting in %26 becoming &. The converted value is then stored in $val. Then, a new
link is generated by appending $val to the href value at. So the generated link becomes:

```

<a href="/page.php?action=view&par=123&amp;action=edit">

```

In doing so, an attacker has managed to add the additional action=edit to the href URL. It could lead to a vulnerability depending on how the server handles receiving this.
